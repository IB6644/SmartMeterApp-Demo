<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CEM6 èª¤çµç·šæ¤œå‡ºã‚¢ãƒ—ãƒª - ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ãƒ‡ãƒ¢</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Helvetica', 'Arial', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            overflow-x: hidden;
        }

        .demo-header {
            text-align: center;
            color: white;
            margin-bottom: 20px;
            width: 100%;
            max-width: 1200px;
        }

        .demo-header h1 {
            font-size: 28px;
            margin-bottom: 8px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .demo-header p {
            font-size: 14px;
            opacity: 0.9;
        }

        .device-selector {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            background: rgba(255,255,255,0.2);
            padding: 10px;
            border-radius: 10px;
            backdrop-filter: blur(10px);
        }

        .device-selector button {
            padding: 10px 20px;
            border: 2px solid white;
            background: transparent;
            color: white;
            border-radius: 20px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .device-selector button.active {
            background: white;
            color: #667eea;
        }

        .device-selector button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        .emulator-container {
            background: #1a1a1a;
            border-radius: 30px;
            padding: 15px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.5);
            transition: all 0.3s ease;
        }

        .emulator-container.phone {
            width: 405px;
        }

        .emulator-container.tablet {
            width: 810px;
        }

        .device-frame {
            background: black;
            border-radius: 20px;
            overflow: hidden;
            position: relative;
            transition: all 0.3s ease;
        }

        .device-frame.phone {
            width: 375px;
            height: 667px;
        }

        .device-frame.tablet {
            width: 768px;
            height: 1024px;
        }

        .status-bar {
            height: 24px;
            background: #000;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 15px;
            font-size: 11px;
            color: white;
        }

        .status-bar-left {
            display: flex;
            gap: 8px;
        }

        .status-bar-right {
            display: flex;
            gap: 5px;
            align-items: center;
        }

        .app-screen {
            height: calc(100% - 24px);
            background: #f5f5f5;
            overflow-y: auto;
            position: relative;
        }

        .screen {
            display: none;
            flex-direction: column;
            height: 100%;
        }

        .screen.active {
            display: flex;
        }

        .header {
            background: #aa0000;
            color: white;
            padding: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .header h2 {
            font-size: 18px;
            font-weight: 600;
        }

        .help-btn {
            background: none;
            border: none;
            color: white;
            font-size: 20px;
            cursor: pointer;
            padding: 5px;
        }

        .content {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
        }

        .welcome-section {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .welcome-section h3 {
            color: #aa0000;
            margin-bottom: 10px;
            font-size: 20px;
        }

        .welcome-section p {
            color: #666;
            line-height: 1.6;
        }

        .feature-card {
            background: white;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            cursor: pointer;
            transition: all 0.2s ease;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .feature-card:active {
            transform: scale(0.98);
            box-shadow: 0 1px 2px rgba(0,0,0,0.1);
        }

        .feature-icon {
            width: 50px;
            height: 50px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            margin-right: 15px;
        }

        .feature-text {
            flex: 1;
        }

        .feature-text h4 {
            font-size: 16px;
            margin-bottom: 4px;
            color: #333;
        }

        .feature-text p {
            font-size: 13px;
            color: #666;
        }

        .chevron {
            color: #999;
            font-size: 20px;
        }

        .connection-status {
            background: white;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .status-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #ccc;
        }

        .status-indicator.connected {
            background: #4caf50;
            box-shadow: 0 0 10px rgba(76,175,80,0.5);
        }

        .status-indicator.connecting {
            background: #ff9800;
            animation: pulse 1.5s infinite;
        }

        .status-indicator.error {
            background: #f44336;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .status-text {
            flex: 1;
        }

        .status-text h4 {
            font-size: 14px;
            margin-bottom: 2px;
        }

        .status-text p {
            font-size: 12px;
            color: #666;
        }

        .action-button {
            width: 100%;
            padding: 15px;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            margin-bottom: 10px;
        }

        .action-button.primary {
            background: #aa0000;
            color: white;
        }

        .action-button.secondary {
            background: #2196f3;
            color: white;
        }

        .action-button.success {
            background: #4caf50;
            color: white;
        }

        .action-button:disabled {
            background: #ccc;
            cursor: not-allowed;
        }

        .action-button:active:not(:disabled) {
            transform: scale(0.98);
        }

        .data-grid {
            background: white;
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 15px;
        }

        .data-grid-header {
            background: #f0f0f0;
            padding: 12px 15px;
            font-weight: 600;
            font-size: 14px;
            border-bottom: 1px solid #ddd;
        }

        .data-grid-row {
            display: flex;
            padding: 12px 15px;
            border-bottom: 1px solid #f0f0f0;
        }

        .data-grid-row:last-child {
            border-bottom: none;
        }

        .data-grid-label {
            flex: 1;
            font-size: 13px;
            color: #666;
        }

        .data-grid-value {
            flex: 1;
            font-size: 13px;
            color: #333;
            font-weight: 500;
            text-align: right;
        }

        .info-section {
            background: #e3f2fd;
            padding: 15px;
            border-radius: 10px;
            border-left: 4px solid #2196f3;
        }

        .info-section h4 {
            color: #1976d2;
            margin-bottom: 10px;
            font-size: 14px;
        }

        .info-item {
            display: flex;
            align-items: flex-start;
            margin-bottom: 8px;
            gap: 8px;
        }

        .info-item:last-child {
            margin-bottom: 0;
        }

        .info-item-icon {
            color: #4caf50;
            font-size: 16px;
            margin-top: 2px;
        }

        .info-item p {
            font-size: 13px;
            color: #555;
            line-height: 1.5;
        }

        .form-group {
            background: white;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            font-size: 13px;
            font-weight: 600;
            color: #333;
            margin-bottom: 8px;
        }

        .form-group select,
        .form-group input {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 14px;
        }

        .timer-display {
            background: white;
            padding: 30px;
            border-radius: 10px;
            text-align: center;
            margin-bottom: 15px;
        }

        .timer-display h3 {
            font-size: 48px;
            color: #aa0000;
            font-weight: 700;
            font-family: 'Courier New', monospace;
        }

        .timer-display p {
            font-size: 14px;
            color: #666;
            margin-top: 10px;
        }

        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 9999;
        }

        .loading-overlay.active {
            display: flex;
        }

        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 4px solid rgba(255,255,255,0.3);
            border-top-color: white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .excel-format-selector {
            background: white;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
        }

        .format-option {
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
            margin-bottom: 10px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .format-option:hover {
            border-color: #aa0000;
            background: #fff5f5;
        }

        .format-option.selected {
            border-color: #aa0000;
            background: #fff5f5;
        }

        .format-option h4 {
            font-size: 15px;
            color: #333;
            margin-bottom: 4px;
        }

        .format-option p {
            font-size: 12px;
            color: #666;
        }

        .result-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
        }

        .result-badge.normal {
            background: #e8f5e9;
            color: #2e7d32;
        }

        .result-badge.abnormal {
            background: #ffebee;
            color: #c62828;
        }

        .info-panel {
            max-width: 1200px;
            width: 100%;
            margin-top: 40px;
            padding: 0 20px;
        }

        .info-card {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 20px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .info-card h2 {
            color: #aa0000;
            font-size: 24px;
            margin-bottom: 20px;
        }

        .info-card h3 {
            color: #333;
            font-size: 18px;
            margin-top: 20px;
            margin-bottom: 10px;
        }

        .info-card p {
            color: #666;
            line-height: 1.8;
            margin-bottom: 15px;
        }

        .info-card ul {
            color: #666;
            line-height: 1.8;
            margin-left: 20px;
            margin-bottom: 15px;
        }

        .download-buttons {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            margin-top: 20px;
        }

        .download-btn {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            padding: 15px 25px;
            border-radius: 10px;
            text-decoration: none;
            font-weight: 600;
            font-size: 16px;
            transition: all 0.3s ease;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .download-btn.primary {
            background: #aa0000;
            color: white;
        }

        .download-btn.github {
            background: #333;
            color: white;
        }

        .download-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }

        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .feature-item {
            background: #f5f5f5;
            padding: 20px;
            border-radius: 10px;
            border-left: 4px solid #aa0000;
        }

        .feature-item h4 {
            color: #aa0000;
            font-size: 16px;
            margin-bottom: 8px;
        }

        .feature-item p {
            color: #666;
            font-size: 14px;
            margin: 0;
        }

        @media (max-width: 768px) {
            .emulator-container {
                transform: scale(0.9);
            }
            
            .demo-header h1 {
                font-size: 22px;
            }

            .info-panel {
                margin-top: 20px;
            }

            .info-card {
                padding: 20px;
            }

            .download-buttons {
                flex-direction: column;
            }

            .download-btn {
                width: 100%;
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <div class="demo-header">
        <h1>CEM6 èª¤çµç·šæ¤œå‡ºã‚¢ãƒ—ãƒª</h1>
        <p>ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ãƒ‡ãƒ¢ - ã‚¹ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ³ãƒ»ã‚¿ãƒ–ãƒ¬ãƒƒãƒˆã§ã®å‹•ä½œç¢ºèª</p>
    </div>

    <div class="device-selector">
        <button class="device-btn active" onclick="switchDevice('phone')">ğŸ“± ã‚¹ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ³</button>
        <button class="device-btn" onclick="switchDevice('tablet')">ğŸ“± ã‚¿ãƒ–ãƒ¬ãƒƒãƒˆ</button>
    </div>

    <div class="emulator-container phone" id="emulator">
        <div class="device-frame phone" id="deviceFrame">
            <div class="status-bar">
                <div class="status-bar-left">
                    <span id="time">12:34</span>
                </div>
                <div class="status-bar-right">
                    <span>ğŸ“¶</span>
                    <span>ğŸ“¡</span>
                    <span>ğŸ”‹</span>
                </div>
            </div>
            
            <div class="app-screen">
                <!-- ãƒ›ãƒ¼ãƒ ç”»é¢ -->
                <div class="screen active" id="homeScreen">
                    <div class="header">
                        <h2>CEM6 èª¤çµç·šæ¤œå‡º</h2>
                        <button class="help-btn" onclick="showHelp()">â“˜</button>
                    </div>
                    <div class="content">
                        <div class="welcome-section">
                            <h3>ã‚ˆã†ã“ã</h3>
                            <p>é›»åŠ›é‡è¨ˆã®è¨ˆå™¨æƒ…å ±å–å¾—ã€èª¤çµç·šåˆ¤å®šã€è¨ˆé‡è©¦é¨“ã‚’è¡Œã„ã¾ã™ã€‚</p>
                        </div>

                        <div class="feature-card" onclick="navigateTo('meterInfo')">
                            <div class="feature-icon" style="background: #2196f3;">â„¹ï¸</div>
                            <div class="feature-text">
                                <h4>è¨ˆå™¨æƒ…å ±å–å¾—</h4>
                                <p>TP-BTçµŒç”±ã§é›»åŠ›é‡è¨ˆã®è©³ç´°æƒ…å ±ã‚’å–å¾—</p>
                            </div>
                            <span class="chevron">â€º</span>
                        </div>

                        <div class="feature-card" onclick="navigateTo('misconnection')">
                            <div class="feature-icon" style="background: #ff9800;">âš ï¸</div>
                            <div class="feature-text">
                                <h4>èª¤çµç·šç¢ºèª</h4>
                                <p>CEM6ã‚·ãƒªãƒ¼ã‚ºã®é…ç·šãƒã‚§ãƒƒã‚¯ãƒ»ç•°å¸¸åˆ¤å®š</p>
                            </div>
                            <span class="chevron">â€º</span>
                        </div>

                        <div class="feature-card" onclick="navigateTo('measurement')">
                            <div class="feature-icon" style="background: #4caf50;">ğŸ“Š</div>
                            <div class="feature-text">
                                <h4>è¨ˆé‡å€¤ç¢ºèª</h4>
                                <p>è¨ˆé‡å€¤ã®è‡ªå‹•å–å¾—ã¨å·®åˆ†è¨ˆç®—</p>
                            </div>
                            <span class="chevron">â€º</span>
                        </div>

                        <div class="info-section">
                            <h4>ä½¿ç”¨å‰ã®ç¢ºèªäº‹é …</h4>
                            <div class="info-item">
                                <span class="info-item-icon">âœ“</span>
                                <p>TP-BTãƒ‡ãƒã‚¤ã‚¹ã¨ãƒšã‚¢ãƒªãƒ³ã‚°æ¸ˆã¿ã§ã‚ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¦ãã ã•ã„</p>
                            </div>
                            <div class="info-item">
                                <span class="info-item-icon">âœ“</span>
                                <p>Bluetoothé€šä¿¡ãŒæœ‰åŠ¹ã«ãªã£ã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¦ãã ã•ã„</p>
                            </div>
                            <div class="info-item">
                                <span class="info-item-icon">âœ“</span>
                                <p>é›»åŠ›é‡è¨ˆãŒæ¸¬å®šå¯èƒ½ãªçŠ¶æ…‹ã§ã‚ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¦ãã ã•ã„</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- è¨ˆå™¨æƒ…å ±å–å¾—ç”»é¢ -->
                <div class="screen" id="meterInfoScreen">
                    <div class="header">
                        <button class="help-btn" onclick="navigateTo('home')">â€¹ æˆ»ã‚‹</button>
                        <h2>è¨ˆå™¨æƒ…å ±å–å¾—</h2>
                        <button class="help-btn" onclick="showHelp()">â“˜</button>
                    </div>
                    <div class="content">
                        <div class="connection-status">
                            <div class="status-indicator" id="meterStatusIndicator"></div>
                            <div class="status-text">
                                <h4 id="meterStatusText">æœªæ¥ç¶š</h4>
                                <p id="meterDeviceName">TP-BTãƒ‡ãƒã‚¤ã‚¹ã«æ¥ç¶šã—ã¦ãã ã•ã„</p>
                            </div>
                        </div>

                        <button class="action-button primary" id="meterConnectBtn" onclick="connectMeterBluetooth()">
                            Bluetoothæ¥ç¶š
                        </button>

                        <button class="action-button secondary" id="meterFetchBtn" onclick="fetchMeterInfo()" disabled>
                            è¨ˆå™¨æƒ…å ±å–å¾—
                        </button>

                        <div id="meterInfoData" style="display: none;">
                            <div class="data-grid">
                                <div class="data-grid-header">åŸºæœ¬æƒ…å ±</div>
                                <div class="data-grid-row">
                                    <div class="data-grid-label">è¨ˆå™¨ID</div>
                                    <div class="data-grid-value">CEM6-001234</div>
                                </div>
                                <div class="data-grid-row">
                                    <div class="data-grid-label">è£½é€ No</div>
                                    <div class="data-grid-value">2024010123456</div>
                                </div>
                                <div class="data-grid-row">
                                    <div class="data-grid-label">å½¢å</div>
                                    <div class="data-grid-value">CEM6-3P3W</div>
                                </div>
                                <div class="data-grid-row">
                                    <div class="data-grid-label">ç›¸ç·šå¼</div>
                                    <div class="data-grid-value">ä¸‰ç›¸3ç·šå¼</div>
                                </div>
                                <div class="data-grid-row">
                                    <div class="data-grid-label">å®šæ ¼é›»åœ§</div>
                                    <div class="data-grid-value">200 V</div>
                                </div>
                                <div class="data-grid-row">
                                    <div class="data-grid-label">å®šæ ¼é›»æµ</div>
                                    <div class="data-grid-value">60 A</div>
                                </div>
                            </div>

                            <div class="data-grid">
                                <div class="data-grid-header">è¨ˆé‡å€¤æƒ…å ±</div>
                                <div class="data-grid-row">
                                    <div class="data-grid-label">æœ‰åŠ¹é›»åŠ›é‡</div>
                                    <div class="data-grid-value">12,345.67 kWh</div>
                                </div>
                                <div class="data-grid-row">
                                    <div class="data-grid-label">ç„¡åŠ¹é›»åŠ›é‡</div>
                                    <div class="data-grid-value">2,345.12 kvarh</div>
                                </div>
                                <div class="data-grid-row">
                                    <div class="data-grid-label">ç¾åœ¨é›»åŠ›</div>
                                    <div class="data-grid-value">3.45 kW</div>
                                </div>
                            </div>

                            <button class="action-button success" onclick="navigateTo('excelExport')">
                                Excelå‡ºåŠ›
                            </button>
                        </div>
                    </div>
                </div>

                <!-- èª¤çµç·šç¢ºèªç”»é¢ -->
                <div class="screen" id="misconnectionScreen">
                    <div class="header">
                        <button class="help-btn" onclick="navigateTo('home')">â€¹ æˆ»ã‚‹</button>
                        <h2>èª¤çµç·šç¢ºèª</h2>
                        <button class="help-btn" onclick="showHelp()">â“˜</button>
                    </div>
                    <div class="content">
                        <div class="connection-status">
                            <div class="status-indicator" id="misconnStatusIndicator"></div>
                            <div class="status-text">
                                <h4 id="misconnStatusText">æœªæ¥ç¶š</h4>
                                <p id="misconnDeviceName">TP-BTãƒ‡ãƒã‚¤ã‚¹ã«æ¥ç¶šã—ã¦ãã ã•ã„</p>
                            </div>
                        </div>

                        <button class="action-button primary" id="misconnConnectBtn" onclick="connectMisconnBluetooth()">
                            Bluetoothæ¥ç¶š
                        </button>

                        <div class="form-group">
                            <label>ç›¸ç·šå¼</label>
                            <select id="phaseWireType">
                                <option value="THREE_PHASE_3_WIRE">ä¸‰ç›¸3ç·šå¼</option>
                                <option value="THREE_PHASE_4_WIRE">ä¸‰ç›¸4ç·šå¼</option>
                                <option value="SINGLE_PHASE_2_WIRE">å˜ç›¸2ç·šå¼</option>
                                <option value="SINGLE_PHASE_3_WIRE">å˜ç›¸3ç·šå¼</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label>å®šæ ¼é›»åœ§ (V)</label>
                            <select id="ratedVoltage">
                                <option value="200">200 V</option>
                                <option value="100">100 V</option>
                                <option value="400">400 V</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label>æ¥ç¶šæ©Ÿå™¨</label>
                            <select id="connectedDevice">
                                <option value="SIMULATED_LOAD">æ¨¡æ“¬è² è·</option>
                                <option value="WIRING_CHECKER">é…ç·šãƒã‚§ãƒƒã‚¯æ©Ÿ</option>
                            </select>
                        </div>

                        <button class="action-button secondary" id="misconnCheckBtn" onclick="checkMisconnection()" disabled>
                            é…ç·šãƒã‚§ãƒƒã‚¯å®Ÿè¡Œ
                        </button>

                        <div id="misconnectionResult" style="display: none;">
                            <div class="data-grid">
                                <div class="data-grid-header">åˆ¤å®šçµæœ</div>
                                <div class="data-grid-row">
                                    <div class="data-grid-label">ç·åˆåˆ¤å®š</div>
                                    <div class="data-grid-value">
                                        <span class="result-badge normal">æ­£å¸¸</span>
                                    </div>
                                </div>
                                <div class="data-grid-row">
                                    <div class="data-grid-label">æ¤œå‡ºãƒ‘ã‚¿ãƒ¼ãƒ³</div>
                                    <div class="data-grid-value">-</div>
                                </div>
                                <div class="data-grid-row">
                                    <div class="data-grid-label">æ¤œæŸ»æ—¥æ™‚</div>
                                    <div class="data-grid-value" id="checkDateTime"></div>
                                </div>
                            </div>

                            <div class="data-grid">
                                <div class="data-grid-header">æ¸¬å®šå€¤</div>
                                <div class="data-grid-row">
                                    <div class="data-grid-label">P1 æœ‰åŠ¹é›»åŠ›</div>
                                    <div class="data-grid-value">1.23 kW</div>
                                </div>
                                <div class="data-grid-row">
                                    <div class="data-grid-label">P1 ç„¡åŠ¹é›»åŠ›</div>
                                    <div class="data-grid-value">0.45 kvar</div>
                                </div>
                                <div class="data-grid-row">
                                    <div class="data-grid-label">P3 æœ‰åŠ¹é›»åŠ›</div>
                                    <div class="data-grid-value">1.21 kW</div>
                                </div>
                                <div class="data-grid-row">
                                    <div class="data-grid-label">P3 ç„¡åŠ¹é›»åŠ›</div>
                                    <div class="data-grid-value">0.43 kvar</div>
                                </div>
                            </div>

                            <button class="action-button success" onclick="navigateTo('excelExport')">
                                Excelå‡ºåŠ›
                            </button>
                        </div>
                    </div>
                </div>

                <!-- è¨ˆé‡å€¤ç¢ºèªç”»é¢ -->
                <div class="screen" id="measurementScreen">
                    <div class="header">
                        <button class="help-btn" onclick="navigateTo('home')">â€¹ æˆ»ã‚‹</button>
                        <h2>è¨ˆé‡å€¤ç¢ºèª</h2>
                        <button class="help-btn" onclick="showHelp()">â“˜</button>
                    </div>
                    <div class="content">
                        <div class="connection-status">
                            <div class="status-indicator" id="measureStatusIndicator"></div>
                            <div class="status-text">
                                <h4 id="measureStatusText">æœªæ¥ç¶š</h4>
                                <p id="measureDeviceName">TP-BTãƒ‡ãƒã‚¤ã‚¹ã«æ¥ç¶šã—ã¦ãã ã•ã„</p>
                            </div>
                        </div>

                        <button class="action-button primary" id="measureConnectBtn" onclick="connectMeasureBluetooth()">
                            Bluetoothæ¥ç¶š
                        </button>

                        <div class="timer-display">
                            <h3 id="timerDisplay">00:00</h3>
                            <p>è¨ˆé‡è©¦é¨“ã‚¿ã‚¤ãƒãƒ¼</p>
                        </div>

                        <button class="action-button secondary" id="measureStartBtn" onclick="startMeasurement()" disabled>
                            è¨ˆé‡é–‹å§‹
                        </button>

                        <button class="action-button" id="measureStopBtn" onclick="stopMeasurement()" disabled style="background: #f44336; color: white;">
                            è¨ˆé‡åœæ­¢
                        </button>

                        <div id="measurementData" style="display: none;">
                            <div class="data-grid">
                                <div class="data-grid-header">è¨ˆé‡è¨˜éŒ²</div>
                                <div class="data-grid-row">
                                    <div class="data-grid-label">é–‹å§‹å€¤</div>
                                    <div class="data-grid-value">12,345.67 kWh</div>
                                </div>
                                <div class="data-grid-row">
                                    <div class="data-grid-label">çµ‚äº†å€¤</div>
                                    <div class="data-grid-value">12,346.12 kWh</div>
                                </div>
                                <div class="data-grid-row">
                                    <div class="data-grid-label">å·®åˆ†</div>
                                    <div class="data-grid-value" style="color: #aa0000; font-weight: 700;">0.45 kWh</div>
                                </div>
                                <div class="data-grid-row">
                                    <div class="data-grid-label">è¨ˆé‡æ™‚é–“</div>
                                    <div class="data-grid-value" id="measurementTime">0ç§’</div>
                                </div>
                            </div>

                            <button class="action-button success" onclick="navigateTo('excelExport')">
                                Excelå‡ºåŠ›
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Excelå‡ºåŠ›ç”»é¢ -->
                <div class="screen" id="excelExportScreen">
                    <div class="header">
                        <button class="help-btn" onclick="navigateTo('home')">â€¹ æˆ»ã‚‹</button>
                        <h2>Excelå‡ºåŠ›</h2>
                        <button class="help-btn" onclick="showHelp()">â“˜</button>
                    </div>
                    <div class="content">
                        <div class="excel-format-selector">
                            <h4 style="margin-bottom: 15px; color: #333;">å‡ºåŠ›ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆé¸æŠ</h4>
                            
                            <div class="format-option selected" onclick="selectFormat('A')">
                                <h4>ğŸ“„ ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆA (ãã‚“ã§ã‚“ç¤¾ç”¨)</h4>
                                <p>è¨ˆé‡å¯¾è±¡åã€éšã€è¨­ç½®å ´æ‰€ç­‰ã®è©³ç´°æƒ…å ±ã‚’å«ã‚€</p>
                            </div>

                            <div class="format-option" onclick="selectFormat('B')">
                                <h4>ğŸ“„ ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆB (å¤§å´æ¨™æº–)</h4>
                                <p>æ¨™æº–çš„ãªè¨ˆå™¨æƒ…å ±ãƒ»åˆ¤å®šçµæœ</p>
                            </div>

                            <div class="format-option" onclick="selectFormat('C')">
                                <h4>ğŸ“„ ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆC (ã‚¹ãƒ‘ã‚¤ãƒ€ãƒ¼ãƒ—ãƒ©ã‚¹é€£æº)</h4>
                                <p>å¤–éƒ¨ã‚·ã‚¹ãƒ†ãƒ é€£æºç”¨ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ</p>
                            </div>
                        </div>

                        <div class="form-group">
                            <label>è¨ˆé‡å¯¾è±¡åï¼ˆä»»æ„ï¼‰</label>
                            <input type="text" placeholder="ä¾‹: Aæ£Ÿ3éš" id="targetName">
                        </div>

                        <div class="form-group">
                            <label>è¨­ç½®å ´æ‰€ï¼ˆä»»æ„ï¼‰</label>
                            <input type="text" placeholder="ä¾‹: é›»æ°—å®¤" id="location">
                        </div>

                        <div class="form-group">
                            <label>å‚™è€ƒï¼ˆä»»æ„ï¼‰</label>
                            <input type="text" placeholder="ä¾‹: å®šæœŸç‚¹æ¤œ" id="remarks">
                        </div>

                        <button class="action-button success" onclick="exportExcel()">
                            Excelãƒ•ã‚¡ã‚¤ãƒ«å‡ºåŠ›
                        </button>

                        <div class="info-section" style="margin-top: 15px;">
                            <h4>å‡ºåŠ›æƒ…å ±</h4>
                            <div class="info-item">
                                <span class="info-item-icon">âœ“</span>
                                <p>ãƒ•ã‚¡ã‚¤ãƒ«ã¯Downloadsãƒ•ã‚©ãƒ«ãƒ€ã«ä¿å­˜ã•ã‚Œã¾ã™</p>
                            </div>
                            <div class="info-item">
                                <span class="info-item-icon">âœ“</span>
                                <p>ãƒ•ã‚¡ã‚¤ãƒ«å: CEM6_èª¤çµç·šæ¤œå‡º_YYYYMMDD_HHMMSS.xlsx</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-spinner"></div>
    </div>

    <!-- æƒ…å ±ãƒ‘ãƒãƒ« -->
    <div class="info-panel">
        <div class="info-card">
            <h2>ğŸ“± ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦</h2>
            <p>ã“ã®ãƒ‡ãƒ¢ã‚µã‚¤ãƒˆã¯ã€å¤§å´é›»æ°—å·¥æ¥­æ ªå¼ä¼šç¤¾ã®CEM6ã‚·ãƒªãƒ¼ã‚ºé›»åŠ›é‡è¨ˆå‘ã‘èª¤çµç·šæ¤œå‡ºãƒ¢ãƒã‚¤ãƒ«ã‚¢ãƒ—ãƒªã®UIã‚’ã€Webãƒ–ãƒ©ã‚¦ã‚¶ä¸Šã§å®Œå…¨ã«ä½“é¨“ã§ãã‚‹ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ãªãƒ‡ãƒ¢ãƒ³ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã§ã™ã€‚</p>
        </div>

        <div class="info-card">
            <h2>âœ¨ å®Ÿè£…æ¸ˆã¿æ©Ÿèƒ½</h2>
            <div class="feature-grid">
                <div class="feature-item">
                    <h4>ğŸ“Š è¨ˆå™¨æƒ…å ±å–å¾—</h4>
                    <p>TP-BTçµŒç”±ã§é›»åŠ›é‡è¨ˆã®è©³ç´°æƒ…å ±ã‚’å–å¾—ãƒ»è¡¨ç¤º</p>
                </div>
                <div class="feature-item">
                    <h4>âš ï¸ èª¤çµç·šç¢ºèª</h4>
                    <p>42ãƒ‘ã‚¿ãƒ¼ãƒ³ã®ç•°å¸¸æ¤œçŸ¥ã¨é…ç·šãƒã‚§ãƒƒã‚¯</p>
                </div>
                <div class="feature-item">
                    <h4>â±ï¸ è¨ˆé‡å€¤ç¢ºèª</h4>
                    <p>ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã‚¿ã‚¤ãƒãƒ¼ã§è¨ˆé‡è©¦é¨“ã‚’å®Ÿæ–½</p>
                </div>
                <div class="feature-item">
                    <h4>ğŸ“„ Excelå‡ºåŠ›</h4>
                    <p>3ã¤ã®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆï¼ˆA/B/Cï¼‰ã§çµæœã‚’å‡ºåŠ›</p>
                </div>
            </div>
        </div>

        <div class="info-card">
            <h2>ğŸš€ å®Ÿéš›ã®ã‚¢ãƒ—ãƒª</h2>
            <p>ã“ã®ãƒ‡ãƒ¢ã‚µã‚¤ãƒˆã¯UIã®ç¢ºèªç”¨ã§ã™ã€‚å®Ÿéš›ã®Bluetoothé€šä¿¡ã‚„è¨ˆå™¨ãƒ‡ãƒ¼ã‚¿å–å¾—ã‚’è¡Œã†ã«ã¯ã€æœ¬ç‰©ã®React Nativeã‚¢ãƒ—ãƒªã‚’ã”åˆ©ç”¨ãã ã•ã„ã€‚</p>
            
            <h3>ğŸ“¦ APKãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</h3>
            <div class="download-buttons">
                <a href="https://github.com/IB6644/CEM6-MisconnectionDetect/releases/download/v1.0.0/CEM6-MisconnectionDetect-v1.0.0.apk" class="download-btn primary" download>
                    ğŸ“± APK v1.0.0 ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
                </a>
                <a href="https://github.com/IB6644/CEM6-MisconnectionDetect/blob/main/BUILD_APK_MAC.md" class="download-btn primary" target="_blank">
                    ğŸ“ APKãƒ“ãƒ«ãƒ‰æ‰‹é †ã‚’è¦‹ã‚‹
                </a>
            </div>

            <h3>ğŸ’» React Nativeãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ</h3>
            <div class="download-buttons">
                <a href="https://github.com/IB6644/CEM6-MisconnectionDetect" class="download-btn github" target="_blank">
                    âš¡ CEM6-MisconnectionDetect ãƒªãƒã‚¸ãƒˆãƒª
                </a>
            </div>
        </div>

        <div class="info-card" style="text-align: center; background: #f8f9fa;">
            <p style="margin: 0; color: #666;">
                Â© 2025 å¤§å´é›»æ°—å·¥æ¥­æ ªå¼ä¼šç¤¾ ã‚¤ãƒ³ã‚­ãƒ¥ãƒ™ãƒ¼ã‚·ãƒ§ãƒ³å®¤<br>
                ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼: æ¢…æ¾¤å„ªä¸€ï¼ˆUmeï¼‰
            </p>
        </div>
    </div>

    <script>
        let currentDevice = 'phone';
        let currentScreen = 'home';
        let measurementTimer = null;
        let measurementTime = 0;
        let selectedFormat = 'A';

        function updateTime() {
            const now = new Date();
            const timeString = now.toLocaleTimeString('ja-JP', { hour: '2-digit', minute: '2-digit' });
            document.getElementById('time').textContent = timeString;
        }
        setInterval(updateTime, 1000);
        updateTime();

        function switchDevice(device) {
            currentDevice = device;
            document.querySelectorAll('.device-btn').forEach(btn => btn.classList.remove('active'));
            if (event && event.target) event.target.classList.add('active');
            
            const container = document.getElementById('emulator');
            const frame = document.getElementById('deviceFrame');
            if (container) container.className = 'emulator-container ' + device;
            if (frame) frame.className = 'device-frame ' + device;
        }

        function navigateTo(screen) {
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.getElementById(screen + 'Screen').classList.add('active');
            currentScreen = screen;
        }

        function showHelp() {
            alert('ãƒ˜ãƒ«ãƒ—\n\nã“ã®ã‚¢ãƒ—ãƒªã¯CEM6ã‚·ãƒªãƒ¼ã‚ºé›»åŠ›ãƒ¡ãƒ¼ã‚¿ãƒ¼ã¨Bluetooth SPPé€šä¿¡ã‚’è¡Œã„ã€ãƒ¡ãƒ¼ã‚¿ãƒ¼æƒ…å ±ã®å–å¾—ã€èª¤çµç·šåˆ¤å®šã€æ¸¬å®šãƒ‡ãƒ¼ã‚¿è¨˜éŒ²ã‚’è¡Œã„ã¾ã™ã€‚');
        }

        function connectMeterBluetooth() {
            const indicator = document.getElementById('meterStatusIndicator');
            const statusText = document.getElementById('meterStatusText');
            const deviceName = document.getElementById('meterDeviceName');
            const connectBtn = document.getElementById('meterConnectBtn');
            const fetchBtn = document.getElementById('meterFetchBtn');
            
            indicator.className = 'status-indicator connecting';
            statusText.textContent = 'æ¥ç¶šä¸­...';
            
            setTimeout(() => {
                indicator.className = 'status-indicator connected';
                statusText.textContent = 'æ¥ç¶šæ¸ˆã¿';
                deviceName.textContent = 'TP-BT-001234';
                connectBtn.textContent = 'Bluetoothåˆ‡æ–­';
                fetchBtn.disabled = false;
            }, 2000);
        }

        function fetchMeterInfo() {
            document.getElementById('loadingOverlay').classList.add('active');
            setTimeout(() => {
                document.getElementById('loadingOverlay').classList.remove('active');
                document.getElementById('meterInfoData').style.display = 'block';
            }, 1500);
        }

        function connectMisconnBluetooth() {
            const indicator = document.getElementById('misconnStatusIndicator');
            const statusText = document.getElementById('misconnStatusText');
            const deviceName = document.getElementById('misconnDeviceName');
            const checkBtn = document.getElementById('misconnCheckBtn');
            
            indicator.className = 'status-indicator connecting';
            statusText.textContent = 'æ¥ç¶šä¸­...';
            
            setTimeout(() => {
                indicator.className = 'status-indicator connected';
                statusText.textContent = 'æ¥ç¶šæ¸ˆã¿';
                deviceName.textContent = 'TP-BT-001234';
                checkBtn.disabled = false;
            }, 2000);
        }

        function checkMisconnection() {
            document.getElementById('loadingOverlay').classList.add('active');
            setTimeout(() => {
                document.getElementById('loadingOverlay').classList.remove('active');
                document.getElementById('misconnectionResult').style.display = 'block';
                document.getElementById('checkDateTime').textContent = new Date().toLocaleString('ja-JP');
            }, 2500);
        }

        function connectMeasureBluetooth() {
            const indicator = document.getElementById('measureStatusIndicator');
            const statusText = document.getElementById('measureStatusText');
            const deviceName = document.getElementById('measureDeviceName');
            const startBtn = document.getElementById('measureStartBtn');
            
            indicator.className = 'status-indicator connecting';
            statusText.textContent = 'æ¥ç¶šä¸­...';
            
            setTimeout(() => {
                indicator.className = 'status-indicator connected';
                statusText.textContent = 'æ¥ç¶šæ¸ˆã¿';
                deviceName.textContent = 'TP-BT-001234';
                startBtn.disabled = false;
            }, 2000);
        }

        function startMeasurement() {
            const startBtn = document.getElementById('measureStartBtn');
            const stopBtn = document.getElementById('measureStopBtn');
            const timerDisplay = document.getElementById('timerDisplay');
            
            measurementTime = 0;
            startBtn.disabled = true;
            stopBtn.disabled = false;
            
            measurementTimer = setInterval(() => {
                measurementTime++;
                const minutes = Math.floor(measurementTime / 60).toString().padStart(2, '0');
                const seconds = (measurementTime % 60).toString().padStart(2, '0');
                timerDisplay.textContent = `${minutes}:${seconds}`;
            }, 1000);
            
            document.getElementById('measurementData').style.display = 'block';
        }

        function stopMeasurement() {
            const startBtn = document.getElementById('measureStartBtn');
            const stopBtn = document.getElementById('measureStopBtn');
            
            clearInterval(measurementTimer);
            startBtn.disabled = false;
            stopBtn.disabled = true;
            document.getElementById('measurementTime').textContent = measurementTime + 'ç§’';
        }

        function selectFormat(format) {
            selectedFormat = format;
            document.querySelectorAll('.format-option').forEach(option => option.classList.remove('selected'));
            if (event && event.target) event.target.closest('.format-option').classList.add('selected');
        }

        function exportExcel() {
            alert(`Excelå½¢å¼${selectedFormat}ã§ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã—ã¾ã—ãŸ\n(ãƒ‡ãƒ¢ç‰ˆã§ã¯å®Ÿéš›ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¯ç”Ÿæˆã•ã‚Œã¾ã›ã‚“)`);
        }
    </script>
</body>
</html>
